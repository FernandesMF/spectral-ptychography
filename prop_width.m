%L   1nm        3nm         6nm	        12nm         30nm

Data = [100,1.2987e-12,6.07556e-13,8.85548e-13,1.72203e-12,4.29732e-12;...
200,1.32191e-12,9.60396e-13,1.73187e-12,3.43922e-12,8.59441e-12;...
300,1.35989e-12,1.35828e-12,2.58685e-12,5.15754e-12,1.28916e-11;...
400,1.41144e-12,1.7711e-12,3.44405e-12,6.87613e-12,1.71887e-11;...
500,1.47516e-12,2.19043e-12,4.30215e-12,8.59484e-12,2.14859e-11;...
600,1.54953e-12,2.61314e-12,5.16069e-12,1.03136e-11,2.57831e-11;...
700,1.63311e-12,3.03781e-12,6.01949e-12,1.20324e-11,3.00803e-11;...
800,1.72455e-12,3.46373e-12,6.87844e-12,1.37512e-11,3.43775e-11;...
900,1.82267e-12,3.89049e-12,7.73751e-12,1.54701e-11,3.86747e-11;...
1000,1.92645e-12,4.31783e-12,8.59665e-12,1.71889e-11,4.29719e-11;...
1100,2.03503e-12,4.7456e-12,9.45584e-12,1.89077e-11,4.7269e-11;...
1200,2.14768e-12,5.1737e-12,1.03151e-11,2.06266e-11,5.15662e-11;...
1300,2.26378e-12,5.60204e-12,1.11743e-11,2.23454e-11,5.58634e-11;...
1400,2.38284e-12,6.03058e-12,1.20336e-11,2.40643e-11,6.01606e-11;...
1500,2.50444e-12,6.45928e-12,1.28929e-11,2.57832e-11,6.44578e-11;...
1600,2.62822e-12,6.8881e-12,1.37523e-11,2.7502e-11,6.8755e-11;...
1700,2.75388e-12,7.31703e-12,1.46116e-11,2.92209e-11,7.30522e-11;...
1800,2.88119e-12,7.74605e-12,1.5471e-11,3.09398e-11,7.73494e-11;...
1900,3.00993e-12,8.17514e-12,1.63303e-11,3.26586e-11,8.16466e-11;...
2000,3.13992e-12,8.60429e-12,1.71897e-11,3.43775e-11,8.59438e-11;...
2100,3.27102e-12,9.0335e-12,1.80491e-11,3.60964e-11,9.0241e-11;...
2200,3.4031e-12,9.46275e-12,1.89084e-11,3.78152e-11,9.45381e-11;...
2300,3.53605e-12,9.89205e-12,1.97678e-11,3.95341e-11,9.88353e-11;...
2400,3.66977e-12,1.03214e-11,2.06272e-11,4.1253e-11,1.03133e-10;...
2500,3.80419e-12,1.07507e-11,2.14866e-11,4.29718e-11,1.0743e-10;...
2600,3.93923e-12,1.11801e-11,2.2346e-11,4.46907e-11,1.11727e-10;...
2700,4.07483e-12,1.16095e-11,2.32054e-11,4.64096e-11,1.16024e-10;...
2800,4.21093e-12,1.2039e-11,2.40648e-11,4.81285e-11,1.20321e-10;...
2900,4.3475e-12,1.24684e-11,2.49242e-11,4.98473e-11,1.24618e-10;...
3000,4.48448e-12,1.28979e-11,2.57836e-11,5.15662e-11,1.28916e-10;...
3100,4.62183e-12,1.33274e-11,2.6643e-11,5.32851e-11,1.33213e-10;...
3200,4.75954e-12,1.37569e-11,2.75024e-11,5.50039e-11,1.3751e-10;...
3300,4.89756e-12,1.41864e-11,2.83619e-11,5.67228e-11,1.41807e-10;...
3400,5.03588e-12,1.46159e-11,2.92213e-11,5.84417e-11,1.46104e-10;...
3500,5.17446e-12,1.50455e-11,3.00807e-11,6.01606e-11,1.50402e-10;...
3600,5.31329e-12,1.5475e-11,3.09401e-11,6.18794e-11,1.54699e-10;...
3700,5.45235e-12,1.59046e-11,3.17995e-11,6.35983e-11,1.58996e-10;...
3800,5.59162e-12,1.63341e-11,3.26589e-11,6.53172e-11,1.63293e-10;...
3900,5.73108e-12,1.67637e-11,3.35184e-11,6.70361e-11,1.6759e-10;...
4000,5.87073e-12,1.71933e-11,3.43778e-11,6.87549e-11,1.71888e-10;...
4100,6.01054e-12,1.76229e-11,3.52372e-11,7.04738e-11,1.76185e-10;...
4200,6.15052e-12,1.80525e-11,3.60966e-11,7.21927e-11,1.80482e-10;...
4300,6.29064e-12,1.84821e-11,3.6956e-11,7.39116e-11,1.84779e-10;...
4400,6.4309e-12,1.89117e-11,3.78155e-11,7.56304e-11,1.89076e-10;...
4500,6.57128e-12,1.93413e-11,3.86749e-11,7.73493e-11,1.93373e-10;...
4600,6.71179e-12,1.97709e-11,3.95343e-11,7.90682e-11,1.97671e-10;...
4700,6.85241e-12,2.02005e-11,4.03937e-11,8.07871e-11,2.01968e-10;...
4800,6.99314e-12,2.06302e-11,4.12532e-11,8.25059e-11,2.06265e-10;...
4900,7.13396e-12,2.10598e-11,4.21126e-11,8.42248e-11,2.10562e-10;...
5000,7.27488e-12,2.14894e-11,4.2972e-11,8.59437e-11,2.14858e-10;...
5100,7.41589e-12,2.1919e-11,4.38315e-11,8.76626e-11,2.19155e-10;...
5200,7.55699e-12,2.23487e-11,4.46909e-11,8.93814e-11,2.23451e-10;...
5300,7.69816e-12,2.27783e-11,4.55503e-11,9.11003e-11,2.27746e-10;...
5400,7.83941e-12,2.3208e-11,4.64097e-11,9.28192e-11,2.32041e-10;...
5500,7.98072e-12,2.36376e-11,4.72692e-11,9.45381e-11,2.36335e-10;...
5600,8.12211e-12,2.40673e-11,4.81286e-11,9.62569e-11,2.40628e-10;...
5700,8.26356e-12,2.44969e-11,4.8988e-11,9.79758e-11,2.4492e-10;...
5800,8.40507e-12,2.49266e-11,4.98475e-11,9.96947e-11,2.4921e-10;...
5900,8.54664e-12,2.53562e-11,5.07069e-11,1.01414e-10,2.53498e-10;...
6000,8.68826e-12,2.57859e-11,5.15663e-11,1.03132e-10,2.57783e-10;...
6100,8.82994e-12,2.62155e-11,5.24258e-11,1.04851e-10,2.62065e-10;...
6200,8.97166e-12,2.66452e-11,5.32852e-11,1.0657e-10,2.66343e-10;...
6300,9.11343e-12,2.70749e-11,5.41446e-11,1.08289e-10,2.70617e-10;...
6400,9.25525e-12,2.75045e-11,5.5004e-11,1.10008e-10,2.74885e-10;...
6500,9.39711e-12,2.79342e-11,5.58635e-11,1.11727e-10,2.79148e-10;...
6600,9.53901e-12,2.83639e-11,5.67229e-11,1.13446e-10,2.83404e-10;...
6700,9.68096e-12,2.87935e-11,5.75823e-11,1.15165e-10,2.87652e-10;...
6800,9.82293e-12,2.92232e-11,5.84418e-11,1.16883e-10,2.91891e-10;...
6900,9.96495e-12,2.96529e-11,5.93012e-11,1.18602e-10,2.9612e-10;...
7000,1.0107e-11,3.00826e-11,6.01606e-11,1.20321e-10,3.00339e-10;...
7100,1.02491e-11,3.05122e-11,6.10201e-11,1.2204e-10,3.04546e-10;...
7200,1.03912e-11,3.09419e-11,6.18795e-11,1.23759e-10,3.0874e-10;...
7300,1.05333e-11,3.13716e-11,6.27389e-11,1.25478e-10,3.12919e-10;...
7400,1.06755e-11,3.18013e-11,6.35984e-11,1.27197e-10,3.17082e-10;...
7500,1.08177e-11,3.2231e-11,6.44578e-11,1.28916e-10,3.21229e-10;...
7600,1.09599e-11,3.26606e-11,6.53172e-11,1.30634e-10,3.25358e-10;...
7700,1.11022e-11,3.30903e-11,6.61767e-11,1.32353e-10,3.29468e-10;...
7800,1.12445e-11,3.35200e-11,6.70361e-11,1.34072e-10,3.33557e-10;...
7900,1.13868e-11,3.39497e-11,6.78955e-11,1.35791e-10,3.37624e-10;...
8000,1.15291e-11,3.43794e-11,6.8755e-11,1.3751e-10,3.41667e-10;...
8100,1.16715e-11,3.48091e-11,6.96144e-11,1.39229e-10,3.45687e-10;...
8200,1.18138e-11,3.52387e-11,7.04738e-11,1.40948e-10,3.49681e-10;...
8300,1.19562e-11,3.56684e-11,7.13333e-11,1.42667e-10,3.53648e-10;...
8400,1.20986e-11,3.60981e-11,7.21927e-11,1.44385e-10,3.57587e-10;...
8500,1.22411e-11,3.65278e-11,7.30522e-11,1.46104e-10,3.61496e-10;...
8600,1.23835e-11,3.69575e-11,7.39116e-11,1.47823e-10,3.65376e-10;...
8700,1.2526e-11,3.73872e-11,7.4771e-11,1.49542e-10,3.69224e-10;...
8800,1.26685e-11,3.78169e-11,7.56305e-11,1.51261e-10,3.7304e-10;...
8900,1.2811e-11,3.82466e-11,7.64899e-11,1.5298e-10,3.76822e-10;...
9000,1.29535e-11,3.86763e-11,7.73493e-11,1.54699e-10,3.8057e-10;...
9100,1.3096e-11,3.9106e-11,7.82088e-11,1.56418e-10,3.84282e-10;...
9200,1.32386e-11,3.95356e-11,7.90682e-11,1.58136e-10,3.87958e-10;...
9300,1.33811e-11,3.99653e-11,7.99276e-11,1.59855e-10,3.91597e-10;...
9400,1.35237e-11,4.0395e-11,8.07871e-11,1.61574e-10,3.95199e-10;...
9500,1.36663e-11,4.08247e-11,8.16465e-11,1.63293e-10,3.98761e-10;...
9600,1.38089e-11,4.12544e-11,8.25059e-11,1.65012e-10,4.02285e-10;...
9700,1.39515e-11,4.16841e-11,8.33654e-11,1.66731e-10,4.05769e-10;...
9800,1.40942e-11,4.21138e-11,8.42248e-11,1.6845e-10,4.09212e-10;...
9900,1.42368e-11,4.25435e-11,8.50842e-11,1.70169e-10,4.12614e-10;...
10000,1.43795e-11,4.29732e-11,8.59437e-11,1.71887e-10,4.15975e-10;...
10100,1.45221e-11,4.34029e-11,8.68031e-11,1.73606e-10,4.19294e-10;...
10200,1.46648e-11,4.38326e-11,8.76626e-11,1.75325e-10,4.2257e-10;...
10300,1.48075e-11,4.42623e-11,8.8522e-11,1.77044e-10,4.25804e-10;...
10400,1.49502e-11,4.4692e-11,8.93814e-11,1.78763e-10,4.28994e-10;...
10500,1.50929e-11,4.51217e-11,9.02409e-11,1.80482e-10,4.32142e-10;...
10600,1.52356e-11,4.55514e-11,9.11003e-11,1.82201e-10,4.35245e-10;...
10700,1.53784e-11,4.59811e-11,9.19597e-11,1.8392e-10,4.38305e-10;...
10800,1.55211e-11,4.64108e-11,9.28192e-11,1.85638e-10,4.41321e-10;...
10900,1.56638e-11,4.68405e-11,9.36786e-11,1.87357e-10,4.44294e-10;...
11000,1.58066e-11,4.72702e-11,9.4538e-11,1.89076e-10,4.47222e-10;...
11100,1.59494e-11,4.76999e-11,9.53975e-11,1.90795e-10,4.50105e-10;...
11200,1.60921e-11,4.81296e-11,9.62569e-11,1.92514e-10,4.52945e-10;...
11300,1.62349e-11,4.85593e-11,9.71163e-11,1.94233e-10,4.55741e-10;...
11400,1.63777e-11,4.8989e-11,9.79758e-11,1.95952e-10,4.58492e-10;...
11500,1.65205e-11,4.94187e-11,9.88352e-11,1.9767e-10,4.61199e-10;...
11600,1.66633e-11,4.98484e-11,9.96947e-11,1.99389e-10,4.63863e-10;...
11700,1.68061e-11,5.02781e-11,1.00554e-10,2.01108e-10,4.66483e-10;...
11800,1.6949e-11,5.07078e-11,1.01414e-10,2.02827e-10,4.69059e-10;...
11900,1.70918e-11,5.11375e-11,1.02273e-10,2.04546e-10,4.71591e-10;...
12000,1.72346e-11,5.15672e-11,1.03132e-10,2.06265e-10,4.7408e-10;...
12100,1.73775e-11,5.19969e-11,1.03992e-10,2.07983e-10,4.76527e-10;...
12200,1.75203e-11,5.24266e-11,1.04851e-10,2.09702e-10,4.7893e-10;...
12300,1.76632e-11,5.28564e-11,1.05711e-10,2.11421e-10,4.81291e-10;...
12400,1.7806e-11,5.32861e-11,1.0657e-10,2.13139e-10,4.8361e-10;...
12500,1.79489e-11,5.37158e-11,1.0743e-10,2.14858e-10,4.85887e-10;...
12600,1.80917e-11,5.41455e-11,1.08289e-10,2.16577e-10,4.88122e-10;...
12700,1.82346e-11,5.45752e-11,1.09148e-10,2.18295e-10,4.90315e-10;...
12800,1.83775e-11,5.50049e-11,1.10008e-10,2.20014e-10,4.92468e-10;...
12900,1.85204e-11,5.54346e-11,1.10867e-10,2.21732e-10,4.9458e-10;...
13000,1.86633e-11,5.58643e-11,1.11727e-10,2.23451e-10,4.96652e-10;...
13100,1.88062e-11,5.6294e-11,1.12586e-10,2.25169e-10,4.98685e-10;...
13200,1.89491e-11,5.67237e-11,1.13446e-10,2.26887e-10,5.00677e-10;...
13300,1.9092e-11,5.71534e-11,1.14305e-10,2.28605e-10,5.02631e-10;...
13400,1.92349e-11,5.75831e-11,1.15165e-10,2.30323e-10,5.04546e-10;...
13500,1.93778e-11,5.80128e-11,1.16024e-10,2.32041e-10,5.06422e-10;...
13600,1.95208e-11,5.84425e-11,1.16883e-10,2.33759e-10,5.08261e-10;...
13700,1.96637e-11,5.88722e-11,1.17743e-10,2.35477e-10,5.10063e-10;...
13800,1.98066e-11,5.9302e-11,1.18602e-10,2.37194e-10,5.11827e-10;...
13900,1.99496e-11,5.97317e-11,1.19462e-10,2.38911e-10,5.13555e-10;...
14000,2.00925e-11,6.01614e-11,1.20321e-10,2.40628e-10,5.15247e-10;...
14100,2.02354e-11,6.05911e-11,1.21181e-10,2.42345e-10,5.16904e-10;...
14200,2.03784e-11,6.10208e-11,1.2204e-10,2.44062e-10,5.18525e-10;...
14300,2.05214e-11,6.14505e-11,1.22899e-10,2.45778e-10,5.20112e-10;...
14400,2.06643e-11,6.18802e-11,1.23759e-10,2.47494e-10,5.21664e-10;...
14500,2.08073e-11,6.23099e-11,1.24618e-10,2.4921e-10,5.23183e-10;...
14600,2.09502e-11,6.27396e-11,1.25478e-10,2.50925e-10,5.24668e-10;...
14700,2.10932e-11,6.31693e-11,1.26337e-10,2.5264e-10,5.26121e-10;...
14800,2.12362e-11,6.3599e-11,1.27197e-10,2.54355e-10,5.27541e-10;...
14900,2.13792e-11,6.40287e-11,1.28056e-10,2.56069e-10,5.28929e-10;...
15000,2.15221e-11,6.44585e-11,1.28916e-10,2.57783e-10,5.30286e-10];

figure(1)
plot(Data(:,1),Data(:,2),...
     Data(:,1),Data(:,3),...
     Data(:,1),Data(:,4),...
     Data(:,1),Data(:,5),...
     Data(:,1),Data(:,6))
 legend('1nm','3nm','6nm','12nm','30nm','Location','NorthWest')

 

%% 25ps jitter
 
foo50 = ones(size(Data(:,1)))*50e-12;
foo35 = ones(size(Data(:,1)))*35e-12;
[~,find50] = min(abs(Data(:,2:6)-50e-12));
[~,find35] = min(abs(Data(:,2:6)-35e-12));
P50 = []; P35 = [];
for r=1:length(find50)
    P50 = [P50; Data(find50(r),1),Data(find50(r),r+1)];
    P35 = [P35; Data(find35(r),1),Data(find35(r),r+1)];
end
 
figure(2)
plot(Data(:,1),Data(:,2),...
     Data(:,1),Data(:,3),...
     Data(:,1),Data(:,4),...
     Data(:,1),Data(:,5),...
     Data(:,1),Data(:,6),...
     Data(:,1),foo50,'k--',...
     Data(:,1),foo35,'k--',...
     P50(:,1),P50(:,2),'ko',...
     P35(:,1),P35(:,2),'ko','MarkerSize',10,'Linewidth',1.5);
set(gca,'YLim',[0 110e-12])
legend('1nm','3nm','6nm','12nm','30nm','Location','SouthEast')
xlabel('Propagation length (m)')
ylabel('Pulse width (s)')
title('25ps jitter')

axPos = get(gca,'Position');
xMinMax = xlim;
yMinMax = ylim;
for r=1:length(find50)
    xPlot = P50(r,1); yPlot = P50(r,2);
    xAnnotation = axPos(1) + ((xPlot - xMinMax(1))/(xMinMax(2)-xMinMax(1))) * axPos(3);
    yAnnotation = axPos(2) + ((yPlot - yMinMax(1))/(yMinMax(2)-yMinMax(1))) * axPos(4);
    dim = [xAnnotation yAnnotation .03 .03];
    str = [num2str(P50(r,1)) 'm'];
    if(xAnnotation>=0 && xAnnotation<=1 && yAnnotation>=0 && yAnnotation<=1)
        annotation('textbox',dim,'String',str,'FitBoxToText','on');
    end
end
for r=1:length(find35)
    xPlot = P35(r,1); yPlot = P35(r,2);
    xAnnotation = axPos(1) + ((xPlot - xMinMax(1))/(xMinMax(2)-xMinMax(1))) * axPos(3);
    yAnnotation = axPos(2) + ((yPlot - yMinMax(1))/(yMinMax(2)-yMinMax(1))) * axPos(4);
    dim = [xAnnotation yAnnotation .03 .03];
    str = [num2str(P35(r,1)) 'm'];
    if(xAnnotation>=0 && xAnnotation<=1 && yAnnotation>=0 && yAnnotation<=1)
        annotation('textbox',dim,'String',str,'FitBoxToText','on');
    end
end

% Printing pretty fig
figure(2)
width = 12;     % Width in inches
height = 6;    % Height in inches
alw = 0.75;    % AxesLineWidth
fsz = 14;      % Fontsize
lw = 2.5;      % LineWidth
msz = 10;       % MarkerSize'pos = get(gcf, 'Position');
pos = get(gcf,'Position');
set(gcf, 'Position', [pos(1) pos(2) width*100, height*100]); %<- Set size
set(gca, 'FontSize', fsz, 'LineWidth', alw); %<- Set properties

% print('25ps-jitter.png','-dpng','-r300')



%% 5ps jitter

foo10 = ones(size(Data(:,1)))*10e-12;
foo07 = ones(size(Data(:,1)))*07e-12;
[~,find10] = min(abs(Data(:,2:6)-10e-12));
[~,find07] = min(abs(Data(:,2:6)-07e-12));
P10 = []; P07 = [];
for r=1:length(find50)
    P10 = [P10; Data(find10(r),1),Data(find10(r),r+1)];
    P07 = [P07; Data(find07(r),1),Data(find07(r),r+1)];
end

figure(3)
plot(Data(:,1),Data(:,2),...
     Data(:,1),Data(:,3),...
     Data(:,1),Data(:,4),...
     Data(:,1),Data(:,5),...
     Data(:,1),Data(:,6),...
     Data(:,1),foo10,'k--',...
     Data(:,1),foo07,'k--',...
     P10(:,1),P10(:,2),'ko',...
     P07(:,1),P07(:,2),'ko','MarkerSize',10,'Linewidth',1.5);
set(gca,'YLim',[0 15e-12])
set(gca,'XLim',[0 5000])
legend('1nm','3nm','6nm','12nm','30nm','Location','SouthEast')
xlabel('Propagation length (m)')
ylabel('Pulse width (s)')
title('5ps jitter')

axPos = get(gca,'Position');
xMinMax = xlim;
yMinMax = ylim;
for r=1:length(find10)
    xPlot = P10(r,1); yPlot = P10(r,2);
    xAnnotation = axPos(1) + ((xPlot - xMinMax(1))/(xMinMax(2)-xMinMax(1))) * axPos(3);
    yAnnotation = axPos(2) + ((yPlot - yMinMax(1))/(yMinMax(2)-yMinMax(1))) * axPos(4);
    dim = [xAnnotation yAnnotation .03 .03];
    str = [num2str(P10(r,1)) 'm'];
    if(xAnnotation>=0 && xAnnotation<=1 && yAnnotation>=0 && yAnnotation<=1)
        annotation('textbox',dim,'String',str,'FitBoxToText','on');
    end
end
for r=1:length(find07)
    xPlot = P07(r,1); yPlot = P07(r,2);
    xAnnotation = axPos(1) + ((xPlot - xMinMax(1))/(xMinMax(2)-xMinMax(1))) * axPos(3);
    yAnnotation = axPos(2) + ((yPlot - yMinMax(1))/(yMinMax(2)-yMinMax(1))) * axPos(4);
    dim = [xAnnotation yAnnotation .03 .03];
    str = [num2str(P07(r,1)) 'm'];
    if(xAnnotation>=0 && xAnnotation<=1 && yAnnotation>=0 && yAnnotation<=1)
        annotation('textbox',dim,'String',str,'FitBoxToText','on');
    end
end

figure(3)
width = 12;     % Width in inches
height = 6;    % Height in inches
alw = 0.75;    % AxesLineWidth
fsz = 14;      % Fontsize
lw = 5.0;      % LineWidth
msz = 10;       % MarkerSize'pos = get(gcf, 'Position');
pos = get(gcf,'Position');
set(gcf, 'Position', [pos(1) pos(2) width*100, height*100]); %<- Set size
set(gca, 'FontSize', fsz, 'LineWidth', alw); %<- Set properties

% print('5ps-jitter.png','-dpng','-r300')